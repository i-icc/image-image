<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IMAGEimage - App Download</title>
  <link rel="stylesheet" href="styles.css">
  <script>
    let releasesData = null;

    async function loadReleases() {
      try {
        const response = await fetch('releases.json');
        releasesData = await response.json();
        updateVersionSelect();
        updateDownloadLink();
        updateReleaseNotes();
      } catch (error) {
        console.error('Failed to load release data:', error);
      }
    }

    function updateVersionSelect() {
      const select = document.getElementById('version-select');
      select.innerHTML = '';
      
      releasesData.releases.forEach(release => {
        const option = document.createElement('option');
        option.value = release.version;
        option.textContent = `v${release.version}${release.isLatest ? ' (Latest)' : ''}`;
        select.appendChild(option);
      });
    }

    function updateDownloadLink() {
      const version = document.getElementById('version-select').value;
      const link = document.getElementById('download-link');
      link.href = `assets/pkg/macos/IMAGEimage_${version}.dmg`;
      link.textContent = `Download for Mac (v${version})`;
    }

    function updateReleaseNotes() {
      const version = document.getElementById('version-select').value;
      const release = releasesData.releases.find(r => r.version === version);
      
      if (release) {
        const notes = release.notes.en;
        const summary = `${release.date} v${release.version} - ${notes.description}`;
        document.getElementById('release-summary').textContent = summary;
      }
    }

    window.addEventListener('DOMContentLoaded', loadReleases);
  </script>
</head>
<body>
  <div class="language-switcher">
    <a href="index.html" class="lang-btn">日本語</a>
    <a href="en.html" class="lang-btn active">English</a>
  </div>
  <div class="appstore-header">
    <img src="assets/images/app_icon_512.png" alt="IMAGEimage Icon" class="appstore-icon">
    <div class="appstore-meta">
      <h1 class="appstore-title">IMAGEimage</h1>
      <p class="appstore-author">by <a href="https://i-icc.github.io/#/" target="_blank">i-icc/某猫</a></p>
      <div class="appstore-download-block">
        <select id="version-select" class="version-select" onchange="updateDownloadLink(); updateReleaseNotes();">
          <option value="0.1.0">v0.1.0 (Latest)</option>
        </select>
        <a id="download-link" class="appstore-download-btn" href="#">Download for Mac</a>
      </div>
    </div>
  </div>
  <div class="appstore-screenshots">
    <img src="assets/images/page1.png" alt="Screenshot 1" class="appstore-screenshot">
    <img src="assets/images/page2.png" alt="Screenshot 2" class="appstore-screenshot">
    <img src="assets/images/page3.png" alt="Screenshot 3" class="appstore-screenshot">
  </div>
  <div class="appstore-description">
    <h2>App Overview</h2>
    <p>IMAGEimage is a Flutter desktop application that allows you to easily compare and compress images. Add images with drag & drop, and perform intuitive compression and comparison of multiple images. Perfect for image management and file size reduction.</p>
    <h3>Key Features</h3>
    <ul>
      <li>Drag & drop image addition</li>
      <li>Batch compression of multiple images</li>
      <li>Customizable compression settings</li>
      <li>Image preview & comparison</li>
    </ul>
  </div>
  <div class="appstore-release-notes">
    <h3>Release Notes</h3>
    <div class="release-info">
      <p id="release-summary" class="release-summary">2025-07-06 v0.1.0 - Initial release of IMAGEimage. Add images with drag & drop and perform batch compression of multiple images. Provides PNG 24bit/32bit to 8bit indexed color conversion functionality.</p>
    </div>
  </div>
  <div class="appstore-license">
    <h3>License</h3>
    <p>IMAGEimage is Free Software released under the WTFPL License.</p>
  </div>
  <div class="appstore-contact">
    <h3>Contact</h3>
    <p>If you have any feedback or requests, please feel free to <a href="https://i-icc.github.io/#/about" target="_blank">contact us</a>.</p>
  </div>
  <footer>
    <p>&copy; 2025 i-icc/某猫</p>
  </footer>
</body>
</html> 